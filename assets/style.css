/*
Style sheet for the Backtester Dash application.
Organized by sections:
1.  Font Size Variables
2.  General Element Styling (body, labels, inputs, buttons)
3.  Layout Specific Styles (header, sidebar, content, footer)
4.  Component Specific Styles (cards, tables, dropdowns, etc.)
5.  Wizard Specific Styles
6.  Results Section Styles
7.  Utility Classes
*/

/* --- Font Size Variables --- */
:root {
  --font-size-base: 1rem;    /* 16px */
  --font-size-sm: 0.875rem; /* 14px */
  --font-size-xs: 0.75rem;  /* 12px */
}

/* --- General Element Styling --- */
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  margin: 0;
  padding: 0;
  background-color: #121212 !important; /* Updated to dark theme background */
  color: #ffffff !important; /* Updated to dark theme text */
  font-size: 80%; /* Reduce base font size to scale UI down */
  min-height: 100vh; /* Ensure body takes full height */
}

/* --- Sticky Footer Layout --- */
.app-container {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.main-content {
  flex: 1;
}

.sticky-footer {
  margin-top: auto;
}

/* --- Form Input Styling --- */
input, .form-control, .form-select, .dbc-input, .Select-control, .Select-menu-outer {
  background-color: #1e222d !important; /* Dark background as per guidelines */
  color: #ffffff !important; /* White text as per guidelines */
  border-color: #444 !important;
}

/* Fix dropdown menu styling to be visible over other elements */
.Select-menu-outer {
  z-index: 1000 !important; /* Ensure dropdown appears above other elements */
  max-height: 300px !important; /* Allow more items to be visible */
  position: absolute !important;
}

/* Make dropdown options visible and correctly styled */
.Select-option {
  background-color: #1e222d !important;
  color: #ffffff !important;
}

.Select-option.is-selected {
  background-color: rgba(13, 110, 253, 0.8) !important;
  color: #ffffff !important;
}

.Select-option.is-focused {
  background-color: rgba(13, 110, 253, 0.5) !important;
  color: #ffffff !important;
}

/* For virtualized dropdown menus */
.VirtualizedSelectOption {
  background-color: #1e222d !important;
  color: #ffffff !important;
}

.VirtualizedSelectFocusedOption {
  background-color: #0d6efd !important;
  color: #ffffff !important;
}

/* Ensure text remains white while typing and on focus */
input::placeholder, .form-control::placeholder {
  color: #adb5bd !important;
}

input:focus, .form-control:focus {
  background-color: #1e222d !important;
  color: #ffffff !important;
  border-color: #0d6efd !important;
}

/* --- Button Styling --- */
.btn, .dbc-button {
  font-size: inherit; /* Removed !important */
}

/* --- Date Picker Styling --- */
.SingleDatePickerInput {
  background-color: #1e222d !important;
  border-color: #444 !important;
}

.DateInput_input {
  text-align: center !important;
  font-weight: 400 !important;
  background-color: #1e222d !important;
  color: #ffffff !important;
  border-color: #444 !important;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
}

/* Fix for the question mark triangle icon */
.DateInput_fangShape, .DateInput_fang {
  display: none !important;
}

/* Remove extra arrows and indicators */
.DateInput_fangStroke {
  display: none !important;
}

/* Ensure the date picker calendar has proper contrast */
.CalendarDay {
  background-color: #2a2e39 !important;
  color: #ffffff !important;
}

.CalendarDay__selected {
  background-color: #0d6efd !important;
  color: white !important;
}

.CalendarDay__today {
  background-color: #343a40 !important;
  color: #ffffff !important;
  border: 1px solid #0d6efd !important;
}

/* --- Layout Specific Styles --- */
.header {
  background-color: #343a40; /* Dark header */
  color: white;
  padding: 1rem;
}

.content {
  padding: 1rem;
}

/* --- Component Specific Styles --- */
.card {
  margin-top: 0 !important; /* Ensure no top margin */
  margin-bottom: 0.25rem !important; /* Consistent small bottom margin, reduced from 0.5rem */
}

.card-header { /* New style for card headers */
  display: flex;
  align-items: center;
  min-height: 28px; /* Further reduced from 32px to make headers shorter */
  padding: 0 !important; /* Remove padding completely and control it in the child div */
  overflow: hidden;
  border-radius: 4px 4px 0 0;
}

.card-title-text { /* New class for title text within card headers */
  text-align: center;
  flex-grow: 1; /* Allow title to take available space for centering */
  margin-bottom: 0; /* Remove default margin from h5/etc if used */
}

.card-title {
    margin-bottom: 0.75rem;
}

/* --- Main Layout Styles --- */
/* Removing previously added incorrect flexbox styles.
   The layout is managed by Bootstrap columns (dbc.Col).
.main-app-layout {
  display: flex;
  padding: 1rem;
}
#left-panel {
  flex: 0 0 20%;
}
#center-panel {
  flex: 1;
  margin-left: 1rem;
  margin-right: 1rem;
}
#right-panel {
  flex: 0 0 30%;
}
*/

/* New styles for panel spacing using padding for Bootstrap dbc.Col components.
   These target the IDs that will be set on the dbc.Col components in app_factory.py.
   This reduces the default Bootstrap column gutter for a 50% visual reduction.
*/
#left-panel-col {
  padding-right: 3.75px !important; /* Further reduced from 7.5px */
  padding-top: 0 !important;
  margin-top: 0 !important;
}

#center-panel-col {
  padding-left: 3.75px !important;  /* Further reduced from 7.5px */
  padding-right: 3.75px !important; /* Further reduced from 7.5px */
}

#right-panel-col {
  padding-left: 3.75px !important;   /* Further reduced from 7.5px */
}

/* Force the left and center panels to be top-aligned */
#left-panel-col, #center-panel-col, #right-panel-col {
  padding-top: 0 !important;
  margin-top: 0 !important;
  vertical-align: top !important;
  align-items: flex-start !important;
  display: flex !important;
  flex-direction: column !important;
}

/* Ensure rows in the dashboard are also top-aligned */
.dash-bootstrap .row {
  align-items: flex-start !important;
}

/* --- End Main Layout Styles --- */

/* --- Progress Bar Styling --- */
.progress-bar-text {
  font-size: var(--font-size-sm) !important; /* Consistent font size */
}

.progress-bar-percentage {
  margin-left: 10px !important; /* Add space to the left of the percentage */
}

/* Ensure striped progress bars are visible */
.progress-bar-striped {
  background-image: linear-gradient(45deg, rgba(255, 255, 255, .15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, .15) 50%, rgba(255, 255, 255, .15) 75%, transparent 75%, transparent) !important;
  background-size: 1rem 1rem !important;
}

/* --- Wizard Specific Styles --- */
/* Consolidated and refined .wizard-step styles */
/* Original definitions were around lines 240-248 and 550-558 */
.wizard-step {
  width: 100%;
  box-sizing: border-box;
  margin-top: 0; /* Ensure no top margin */
  margin-bottom: 6px; /* Consistent small bottom margin, was 0.125rem or 6px !important */
  border-radius: 4px;
  overflow: hidden;
  border: none; /* Explicitly no border for the card itself */
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  transition: box-shadow 0.3s ease;
}

.wizard-step:hover {
  box-shadow: 0 3px 6px rgba(0,0,0,0.3);
}

/* NEW: Styles for wizard layout containers to ensure full width */
.strategy-wizard {
    width: 100%;
    box-sizing: border-box;
}

.wizard-steps { /* This container holds all the wizard step cards */
    width: 100%;
    box-sizing: border-box;
}
/* END NEW */

/* --- Stepper Component Styles --- */
/* Consolidated and refined .wizard-stepper-container */
/* Original definitions were around lines 373-383 and 608-617. Using the latter as a base. */
.wizard-stepper-container {
    width: 100%;
    box-sizing: border-box;
    padding: 8px 0; /* Adjusted for vertical centering of a 44px stepper (60px total height with stepper) */
    margin-bottom: 6px; /* Consistent with wizard-step margin, was 10px or 0.125rem */
    margin-top: -1.25rem !important; /* Kept !important as it seems a deliberate override for layout */
    position: sticky;
    top: 0;
    background-color: #121212; /* Or your page background color */
    z-index: 100; /* Ensure it's above other content */
    /* min-height: 60px; /* This is implicitly handled by padding + stepper height */
}

/* Refined .wizard-stepper. Original was around lines 385-398 and 507-520. */
/* The definition around 507-520 was more complete with overflow:hidden. */
.wizard-stepper {
  display: flex;
  align-items: stretch;       /* Children (indicators) will stretch to fill height */
  /* justify-content: stretch; /* REMOVED - invalid value. flex:1 on children handles distribution. */
  padding: 0;                 /* No internal padding for the flex container itself */
  width: 100%;                /* Take full width of parent (.wizard-stepper-container) */
  height: 44px;               /* Fixed height for the stepper bar */
  box-sizing: border-box;     /* Ensures padding/border don't alter final dimensions */
  background: linear-gradient(to bottom, #444 0%, #333 100%);
  border-radius: 10px;
  overflow: hidden;           /* Important for clipping angled dividers and removing scrollbars */
  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.4);
  position: relative;         /* For z-indexing children or pseudo-elements if any */
  border: 1px solid #222;
}

/* Create angled dividers between steps */
.step-indicator {
  flex: 1;
  position: relative;
  display: flex;
  align-items: center;
  transition: all 0.3s ease;
  overflow: visible;
  border-right: 2px solid #222; /* Add dark border between segments */
}

.step-indicator:last-child {
  border-right: none; /* Remove border from last segment */
}

/* Create the angled dividers between segments - enhanced for visibility */
.step-indicator:not(:last-child)::after {
  content: "";
  position: absolute;
  right: -12px; /* Negative value creates overlap */
  top: 0;
  height: 100%;
  width: 24px; /* Width of the diagonal line - increased */
  background-color: inherit; /* Match the segment color */
  /* Sharp angled divider with improved shape */
  clip-path: polygon(0 0, 50% 0, 100% 50%, 50% 100%, 0 100%);
  z-index: 2;
  /* Add a shadow effect to the right edge of the divider */
  box-shadow: 2px 0 3px rgba(0,0,0,0.3);
}

.step-segment {
  height: 100%;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  padding: 8px;
  transition: background-color 0.3s ease;
  /* Add subtle inner shadow for depth */
  box-shadow: inset 0 0 15px rgba(0,0,0,0.2);
}

.step-number {
  font-weight: bold;
  color: #fff;
  z-index: 3;
  font-size: 1.3em; /* Slightly larger */
  text-shadow: 1px 1px 3px rgba(0,0,0,0.7); /* Enhanced shadow */
  position: relative;
  display: inline-block;
  width: 30px;
  height: 30px;
  line-height: 30px;
  text-align: center;
  border-radius: 50%;
  background-color: rgba(0,0,0,0.2);
  box-shadow: 0 0 8px rgba(255,255,255,0.2);
}

.step-label {
  font-size: var(--font-size-xs);
  text-align: center;
  position: absolute;
  bottom: -18px;
  width: 100%;
  left: 0;
  color: #adb5bd;
  text-shadow: 1px 1px 1px rgba(0,0,0,0.5); /* Add subtle shadow for better visibility */
  font-weight: 500; /* Slightly bolder */
}

/* Step statuses for the progress bar style */
.step-indicator.completed .step-segment {
  background-color: #198754; /* Green for completed */
  color: white;
  box-shadow: inset 0 0 20px rgba(0,0,0,0.2), 0 0 5px rgba(25, 135, 84, 0.5); /* Enhanced inner shadow and subtle glow */
  background-image: linear-gradient(to bottom, rgba(255,255,255,0.15) 0%, rgba(0,0,0,0.15) 100%); /* Gradient for 3D effect */
}

.step-indicator.current .step-segment {
  background-color: #0d6efd; /* Blue for current */
  color: white;
  box-shadow: inset 0 0 10px rgba(255,255,255,0.15), 0 0 15px rgba(13, 110, 253, 0.5); /* Glow effect */
  background-image: linear-gradient(to bottom, rgba(255,255,255,0.2) 0%, rgba(0,0,0,0.15) 100%); /* Gradient for 3D effect */
}

.step-indicator.pending .step-segment {
  background-color: #6c757d; /* Gray for pending */
  color: #ddd;
  /* Add subtle gradient for consistent look */
  background-image: linear-gradient(to bottom, rgba(255,255,255,0.08) 0%, rgba(0,0,0,0.1) 100%);
  box-shadow: inset 0 0 15px rgba(0,0,0,0.2);
}

.step-indicator.completed.clickable {
  cursor: pointer;
  box-shadow: inset 0 0 10px rgba(255,255,255,0.2);
}

/* Header styling to match stepper colors */
/* Refined .wizard-step .card-header (targeting the dbc.CardHeader component) */
/* Original definitions were around lines 460-465 and 570-575. Using the latter as base. */
.wizard-step .card-header {
  padding: 0; /* Remove padding from the CardHeader component itself */
  margin: 0;
  width: 100%;
  /* border-bottom: 1px solid rgba(255,255,255,0.1); /* Removed, as headers have box-shadows */
  overflow: hidden; /* In case child content tries to overflow */
}

/* Step header colors to match stepper segments - with enhanced gradients */
/* These are applied to the html.Div inside the dbc.CardHeader */
.wizard-step-header-completed {
  background-color: rgba(25, 135, 84, 1) !important; /* Solid green */
  color: #fff !important;
  background-image: linear-gradient(to bottom, rgba(255,255,255,0.15) 0%, rgba(0,0,0,0.15) 100%) !important;
  box-shadow: 0 2px 4px rgba(0,0,0,0.25) !important;
  transition: all 0.3s ease;
}

.wizard-step-header-current {
  background-color: rgba(13, 110, 253, 1) !important; /* Solid blue */
  color: #fff !important;
  background-image: linear-gradient(to bottom, rgba(255,255,255,0.2) 0%, rgba(0,0,0,0.15) 100%) !important;
  box-shadow: 0 2px 5px rgba(13, 110, 253, 0.5) !important;
  animation: currentStepPulse 2s infinite alternate;
  transition: all 0.3s ease;
}

.wizard-step-header-pending {
  background-color: rgba(108, 117, 125, 1) !important; /* Solid gray */
  color: #ddd !important;
  background-image: linear-gradient(to bottom, rgba(255,255,255,0.08) 0%, rgba(0,0,0,0.15) 100%) !important;
  transition: all 0.3s ease;
}

/* --- Professional, Consistent Wizard Step Header Styling --- */
/* Common styling for .wizard-step-header-* (the Div inside dbc.CardHeader) */
/* Original was around lines 491-505. Attempting to remove !important. */
.wizard-step-header-completed,
.wizard-step-header-current,
.wizard-step-header-pending {
  width: 100%;
  box-sizing: border-box;
  padding: 4px 8px; /* Maintained original padding */
  text-align: left;
  font-size: 1rem;
  font-weight: 600;
  border: none; /* No border for the inner div */
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  cursor: pointer; /* Assuming headers are clickable */
  transition: background-color 0.3s, box-shadow 0.3s;
  /* Color and background are set by the more specific rules above, !important kept there for now */
}

/* ADDED: Hover effects for step headers */
.wizard-step-header-completed:hover {
  background-color: rgba(21, 115, 71, 1) !important; /* Darker green */
  box-shadow: 0 3px 6px rgba(0,0,0,0.3) !important;
}

.wizard-step-header-current:hover {
  background-color: rgba(10, 88, 202, 1) !important; /* Darker blue */
  box-shadow: 0 3px 7px rgba(13, 110, 253, 0.6) !important;
}

.wizard-step-header-pending:hover {
  background-color: rgba(84, 92, 99, 1) !important; /* Darker gray */
  box-shadow: 0 3px 6px rgba(0,0,0,0.3) !important;
}

/* Ensure the stepper container allows horizontal scrolling if needed */
/* This .wizard-stepper block (around lines 507-520) is a duplicate of the one refined earlier (385-398). */
/* The earlier one is now the primary. This block can be removed or commented if it's truly identical. */
/* For safety, I'll comment out the duplicate block if the tool allows, otherwise assume it's handled by replacing the first instance. */
/* Given the tool's nature, I'll assume the first .wizard-stepper definition is the one being modified. */


/* Enhance animation for current step */
@keyframes currentStepPulse {
  0% {
    box-shadow: 0 2px 5px rgba(13, 110, 253, 0.5);
    background-color: rgba(13, 110, 253, 0.9);
  }
  50% {
    box-shadow: 0 2px 10px rgba(13, 110, 253, 0.8);
    background-color: rgba(13, 110, 253, 1);
  }
  100% {
    box-shadow: 0 2px 5px rgba(13, 110, 253, 0.5);
    background-color: rgba(13, 110, 253, 0.9);
  }
}

/* Style the entire card based on step status */
/* This .wizard-step block (around lines 550-558) is a duplicate of the one refined earlier (240-248). */
/* The earlier one is now the primary. */


/* Adjust card body styling */
.wizard-step .card-body {
  background-color: #1e222d;
  border-top: none;
  padding: 4px 6px; /* Further reduced padding: vertical 4px, horizontal 6px */
  margin-top: 0; /* Remove any potential top margin */
}

/* Ensure the header takes up the entire width */
/* This .wizard-step .card-header block (around lines 570-575) is a duplicate of the one refined earlier (460-465). */
/* The earlier one is now the primary. */


/* Make the header wrapper take the full width with minimal vertical spacing */
/* This rule for .wizard-step .card-header > div (around lines 577-582) is REMOVED */
/* as padding is handled by .wizard-step-header-* classes. */
/* (No code here means it will be effectively deleted if it was the only content in its original spot) */

/* Wizard Stepper Container */
/* This .wizard-stepper-container block (around lines 608-617) is a duplicate of the one refined earlier (373-383). */
/* The earlier one is now the primary. */


/* Stepper Component */
/* The .stepper-container class (around lines 619-627) seems to be an alternative or unused style. */
/* No changes to this unless specified, as it's not explicitly part of the "wizard" components targeted. */
/* ...remaining CSS... */

/* --- Strategy Parameter Inputs Styling --- */
.param-row {
  display: flex;
  align-items: center;
  margin-bottom: 8px;
  padding: 4px 8px;
  border-radius: 4px;
  transition: background-color 0.2s;
}

.param-row:hover {
  background-color: rgba(13, 110, 253, 0.05); /* Subtle highlight on hover */
}

.param-label {
  width: 180px; /* Fixed width for labels */
  flex-shrink: 0;
  display: flex;
  align-items: center;
}

.param-label i {
  margin-right: 6px;
  opacity: 0.7;
  transition: opacity 0.2s;
}

.param-row:hover .param-label i {
  opacity: 1;
}

.param-input {
  flex-grow: 0;
  background-color: #1e222d !important;
  color: #ffffff !important;
  border-color: #444 !important;
  border-radius: 4px;
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
  transition: all 0.3s ease;
}

.param-input:focus {
  border-color: #0d6efd !important;
  box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25) !important;
  outline: 0;
}

/* Parameter container styling */
.params-container {
  background-color: rgba(30, 34, 45, 0.5);
  border-left: 3px solid #0d6efd;
  padding: 10px 12px;
  margin-top: 8px;
  margin-bottom: 16px;
  border-radius: 4px;
}

/* Styling for Bootstrap tooltips */
.tooltip-inner {
  background-color: #343a40 !important;
  color: #ffffff !important;
  border: 1px solid #444 !important;
  max-width: 250px; /* Allow more space for parameter descriptions */
  padding: 8px 10px;
  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
  font-size: 0.85rem;
  line-height: 1.4;
}

/* Animated fade-in effect for tooltips */
.tooltip {
  opacity: 0;
  transition: opacity 0.2s;
}

.tooltip.show {
  opacity: 0.98 !important;
}

.bs-tooltip-left .arrow::before,
.bs-tooltip-auto[x-placement^="left"] .arrow::before {
  border-left-color: #343a40 !important;
}

/* --- Summary Section Styling --- */
.summary-section {
  background-color: #1e222d;
  border-radius: 5px;
  padding: 6px 10px;
  margin-bottom: 8px;
  border-left: 3px solid #0d6efd;
}

.summary-section h5 {
  color: #ffffff;
  margin-bottom: 0.05rem; /* Minimal bottom margin */
  font-weight: 600;
  font-size: 0.95rem; /* Slightly reduced for consistency */
}

.summary-section h6 {
  color: #adb5bd;
  margin-top: 0.05rem; /* Reduced top margin */
  margin-bottom: 0.05rem; /* Minimal bottom margin */
  font-weight: 600;
  font-size: 0.9rem; /* Consistent size */
}

.summary-section .text-muted {
  color: #8a94a0 !important; /* Slightly brighter for better readability */
  font-size: 0.85rem; /* Consistent size */
  margin-bottom: 0.05rem !important; /* Minimal margin */
  line-height: 1.2; /* Compact line height */
}

.summary-section .border-light {
  border-color: rgba(255, 255, 255, 0.1) !important;
}

/* --- Utility Classes --- */
.mb-2 { margin-bottom: 0.5rem !important; }
.mt-2 { margin-top: 0.5rem !important; }
.mb-3 { margin-bottom: 0.5rem !important; } /* Reduced from 1rem */
.mt-3 { margin-top: 1rem !important; }

/* Add more specific styles as needed */

/* --- Custom Button Group Styling --- */
/* Make inactive outline buttons in button groups more visible */
.btn-group > .btn.btn-outline-primary:not(.active) {
  background-color: #2a2e39; /* Slightly lighter dark shade */
  color: #adb5bd;           /* Lighter gray text */
  border-color: #444;       /* Subtle border */
}

/* Optional: Style for hover state */
.btn-group > .btn.btn-outline-primary:not(.active):hover {
  background-color: #343a40; /* Darken slightly on hover */
  color: #f8f9fa;           /* Lighter text on hover */
  border-color: #555;
}