/*
Style sheet for the Backtester Dash application.
Organized by sections:
1.  Font Size Variables
2.  General Element Styling (body, labels, inputs, buttons)
3.  Layout Specific Styles (header, sidebar, content, footer)
4.  Component Specific Styles (cards, tables, dropdowns, etc.)
5.  Wizard Specific Styles
6.  Results Section Styles
7.  Utility Classes
*/

/* --- Font Size Variables --- */
:root {
  --font-size-base: 1rem;    /* 16px */
  --font-size-sm: 0.875rem; /* 14px */
  --font-size-xs: 0.75rem;  /* 12px */
}

/* --- General Element Styling --- */
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  margin: 0;
  padding: 0;
  background-color: #121212 !important; /* Updated to dark theme background */
  color: #ffffff !important; /* Updated to dark theme text */
  font-size: 80%; /* Reduce base font size to scale UI down */
  min-height: 100vh; /* Ensure body takes full height */
}

/* --- Form Input Styling --- */
input, .form-control, .form-select, .dbc-input, .Select-control, .Select-menu-outer {
  background-color: #1e222d !important; /* Dark background as per guidelines */
  color: #ffffff !important; /* White text as per guidelines */
  border-color: #444 !important;
}

/* Fix dropdown menu styling to be visible over other elements */
.Select-menu-outer {
  z-index: 1000 !important; /* Ensure dropdown appears above other elements */
  max-height: 300px !important; /* Allow more items to be visible */
  position: absolute !important;
}

/* Make dropdown options visible and correctly styled */
.Select-option {
  background-color: #1e222d !important;
  color: #ffffff !important;
}

.Select-option.is-selected {
  background-color: rgba(13, 110, 253, 0.8) !important;
  color: #ffffff !important;
}

.Select-option.is-focused {
  background-color: rgba(13, 110, 253, 0.5) !important;
  color: #ffffff !important;
}

/* For virtualized dropdown menus */
.VirtualizedSelectOption {
  background-color: #1e222d !important;
  color: #ffffff !important;
}

.VirtualizedSelectFocusedOption {
  background-color: #0d6efd !important;
  color: #ffffff !important;
}

/* Ensure text remains white while typing and on focus */
input::placeholder, .form-control::placeholder {
  color: #adb5bd !important;
}

input:focus, .form-control:focus {
  background-color: #1e222d !important;
  color: #ffffff !important;
  border-color: #0d6efd !important;
}

/* --- Button Styling --- */
.btn, .dbc-button {
  font-size: inherit; /* Removed !important */
}

/* --- Date Picker Styling --- */
.SingleDatePickerInput {
  background-color: #1e222d !important;
  border-color: #444 !important;
}

.DateInput_input {
  text-align: center !important;
  font-weight: 400 !important;
  background-color: #1e222d !important;
  color: #ffffff !important;
  border-color: #444 !important;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
}

/* Fix for the question mark triangle icon */
.DateInput_fangShape, .DateInput_fang {
  display: none !important;
}

/* Remove extra arrows and indicators */
.DateInput_fangStroke {
  display: none !important;
}

/* Ensure the date picker calendar has proper contrast */
.CalendarDay {
  background-color: #2a2e39 !important;
  color: #ffffff !important;
}

.CalendarDay__selected {
  background-color: #0d6efd !important;
  color: white !important;
}

.CalendarDay__today {
  background-color: #343a40 !important;
  color: #ffffff !important;
  border: 1px solid #0d6efd !important;
}

/* --- Layout Specific Styles --- */
.header {
  background-color: #343a40; /* Dark header */
  color: white;
  padding: 1rem;
}

.content {
  padding: 1rem;
}

/* --- Component Specific Styles --- */
.card {
  margin-top: 0 !important; /* Ensure no top margin */
  margin-bottom: 0.25rem !important; /* Consistent small bottom margin, reduced from 0.5rem */
}

.card-header { /* New style for card headers */
  display: flex;
  align-items: center;
  min-height: 28px; /* Further reduced from 32px to make headers shorter */
  padding: 0 !important; /* Remove padding completely and control it in the child div */
  overflow: hidden;
  border-radius: 4px 4px 0 0;
}

.card-title-text { /* New class for title text within card headers */
  text-align: center;
  flex-grow: 1; /* Allow title to take available space for centering */
  margin-bottom: 0; /* Remove default margin from h5/etc if used */
}

.card-title {
    margin-bottom: 0.75rem;
}

/* --- Main Layout Styles --- */
/* Removing previously added incorrect flexbox styles.
   The layout is managed by Bootstrap columns (dbc.Col).
.main-app-layout {
  display: flex;
  padding: 1rem;
}
#left-panel {
  flex: 0 0 20%;
}
#center-panel {
  flex: 1;
  margin-left: 1rem;
  margin-right: 1rem;
}
#right-panel {
  flex: 0 0 30%;
}
*/

/* New styles for panel spacing using padding for Bootstrap dbc.Col components.
   These target the IDs that will be set on the dbc.Col components in app_factory.py.
   This reduces the default Bootstrap column gutter for a 50% visual reduction.
*/
#left-panel-col {
  padding-right: 3.75px !important; /* Further reduced from 7.5px */
}

#center-panel-col {
  padding-left: 3.75px !important;  /* Further reduced from 7.5px */
  padding-right: 3.75px !important; /* Further reduced from 7.5px */
}

#right-panel-col {
  padding-left: 3.75px !important;   /* Further reduced from 7.5px */
}
/* --- End Main Layout Styles --- */

/* --- Progress Bar Styling --- */
.progress-bar-text {
  font-size: var(--font-size-sm) !important; /* Consistent font size */
}

.progress-bar-percentage {
  margin-left: 10px !important; /* Add space to the left of the percentage */
}

/* Ensure striped progress bars are visible */
.progress-bar-striped {
  background-image: linear-gradient(45deg, rgba(255, 255, 255, .15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, .15) 50%, rgba(255, 255, 255, .15) 75%, transparent 75%, transparent) !important;
  background-size: 1rem 1rem !important;
}

/* --- Wizard Specific Styles --- */
.wizard-step {
  margin-top: 0 !important; /* Ensure no top margin */
  margin-bottom: 0.125rem !important; /* Reduced by half from 0.25rem to minimize space between steps */
  border-radius: 4px;
  overflow: hidden;
  border: none;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  transition: box-shadow 0.3s ease;
}

/* Add hover effect to the wizard step */
.wizard-step:hover {
  box-shadow: 0 3px 6px rgba(0,0,0,0.3);
}

/* --- Stepper Component Styles --- */
.wizard-stepper {
  display: flex;
  align-items: stretch;
  justify-content: stretch;
  margin-bottom: 0.6rem; /* Reduced from 1.5rem to 0.6rem */
  padding: 0;
  width: 100%;
  background: linear-gradient(to bottom, #444 0%, #333 100%);
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.4);
  height: 44px; /* Slightly taller */
  position: relative;
  border: 1px solid #222;
  transform: translateZ(0); /* Force hardware acceleration for smoother animations */
}

/* Progress-bar style stepper */
.wizard-stepper.progress-style {
  height: 44px;
}

/* Create angled dividers between steps */
.step-indicator {
  flex: 1;
  position: relative;
  display: flex;
  align-items: center;
  transition: all 0.3s ease;
  overflow: visible;
  border-right: 2px solid #222; /* Add dark border between segments */
}

.step-indicator:last-child {
  border-right: none; /* Remove border from last segment */
}

/* Create the angled dividers between segments - enhanced for visibility */
.step-indicator:not(:last-child)::after {
  content: "";
  position: absolute;
  right: -12px; /* Negative value creates overlap */
  top: 0;
  height: 100%;
  width: 24px; /* Width of the diagonal line - increased */
  background-color: inherit; /* Match the segment color */
  /* Sharp angled divider with improved shape */
  clip-path: polygon(0 0, 50% 0, 100% 50%, 50% 100%, 0 100%);
  z-index: 2;
  /* Add a shadow effect to the right edge of the divider */
  box-shadow: 2px 0 3px rgba(0,0,0,0.3);
}

.step-segment {
  height: 100%;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  padding: 8px;
  transition: background-color 0.3s ease;
  /* Add subtle inner shadow for depth */
  box-shadow: inset 0 0 15px rgba(0,0,0,0.2);
}

.step-number {
  font-weight: bold;
  color: #fff;
  z-index: 3;
  font-size: 1.3em; /* Slightly larger */
  text-shadow: 1px 1px 3px rgba(0,0,0,0.7); /* Enhanced shadow */
  position: relative;
  display: inline-block;
  width: 30px;
  height: 30px;
  line-height: 30px;
  text-align: center;
  border-radius: 50%;
  background-color: rgba(0,0,0,0.2);
  box-shadow: 0 0 8px rgba(255,255,255,0.2);
}

.step-label {
  font-size: var(--font-size-xs);
  text-align: center;
  position: absolute;
  bottom: -18px;
  width: 100%;
  left: 0;
  color: #adb5bd;
  text-shadow: 1px 1px 1px rgba(0,0,0,0.5); /* Add subtle shadow for better visibility */
  font-weight: 500; /* Slightly bolder */
}

/* Step statuses for the progress bar style */
.step-indicator.completed .step-segment {
  background-color: #198754; /* Green for completed */
  color: white;
  box-shadow: inset 0 0 20px rgba(0,0,0,0.2), 0 0 5px rgba(25, 135, 84, 0.5); /* Enhanced inner shadow and subtle glow */
  background-image: linear-gradient(to bottom, rgba(255,255,255,0.15) 0%, rgba(0,0,0,0.15) 100%); /* Gradient for 3D effect */
}

.step-indicator.current .step-segment {
  background-color: #0d6efd; /* Blue for current */
  color: white;
  box-shadow: inset 0 0 10px rgba(255,255,255,0.15), 0 0 15px rgba(13, 110, 253, 0.5); /* Glow effect */
  background-image: linear-gradient(to bottom, rgba(255,255,255,0.2) 0%, rgba(0,0,0,0.15) 100%); /* Gradient for 3D effect */
}

.step-indicator.pending .step-segment {
  background-color: #6c757d; /* Gray for pending */
  color: #ddd;
  /* Add subtle gradient for consistent look */
  background-image: linear-gradient(to bottom, rgba(255,255,255,0.08) 0%, rgba(0,0,0,0.1) 100%);
  box-shadow: inset 0 0 15px rgba(0,0,0,0.2);
}

.step-indicator.completed.clickable {
  cursor: pointer;
  box-shadow: inset 0 0 10px rgba(255,255,255,0.2);
}

/* Header styling to match stepper colors */
.wizard-step .card-header {
  transition: background-color 0.3s ease;
  border-bottom: 1px solid rgba(255,255,255,0.1);
  padding: 4px !important; /* Reduced from 8px to make headers less tall */
  width: 100% !important; /* Ensure full width */
}

/* Step header colors to match stepper segments - with enhanced gradients */
.wizard-step-header-completed {
  background-color: rgba(25, 135, 84, 1) !important; /* Solid green */
  color: #fff !important;
  /* Add gradient effect to match step indicators */
  background-image: linear-gradient(to bottom, rgba(255,255,255,0.15) 0%, rgba(0,0,0,0.15) 100%) !important;
  box-shadow: 0 2px 4px rgba(0,0,0,0.25) !important;
  transition: all 0.3s ease;
}

.wizard-step-header-current {
  background-color: rgba(13, 110, 253, 1) !important; /* Solid blue */
  color: #fff !important;
  /* Add gradient effect to match step indicators */
  background-image: linear-gradient(to bottom, rgba(255,255,255,0.2) 0%, rgba(0,0,0,0.15) 100%) !important;
  box-shadow: 0 2px 5px rgba(13, 110, 253, 0.5) !important;
  /* Add subtle pulse animation to highlight the current step */
  animation: currentStepPulse 2s infinite alternate;
  transition: all 0.3s ease;
}

.wizard-step-header-pending {
  background-color: rgba(108, 117, 125, 1) !important; /* Solid gray */
  color: #ddd !important;
  /* Add gradient effect to match step indicators */
  background-image: linear-gradient(to bottom, rgba(255,255,255,0.08) 0%, rgba(0,0,0,0.15) 100%) !important;
  transition: all 0.3s ease;
}

/* Enhance animation for current step */
@keyframes currentStepPulse {
  0% {
    box-shadow: 0 2px 5px rgba(13, 110, 253, 0.5);
    background-color: rgba(13, 110, 253, 0.9);
  }
  50% {
    box-shadow: 0 2px 10px rgba(13, 110, 253, 0.8);
    background-color: rgba(13, 110, 253, 1);
  }
  100% {
    box-shadow: 0 2px 5px rgba(13, 110, 253, 0.5);
    background-color: rgba(13, 110, 253, 0.9);
  }
}

/* Style the entire card based on step status */
.wizard-step {
  border-radius: 4px;
  overflow: hidden;
  border: none;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  margin-bottom: 6px !important; /* Reduced from 12px to half the spacing between steps */
}

/* Adjust card body styling */
.wizard-step .card-body {
  background-color: #1e222d;
  border-top: none;
  padding: 4px 6px; /* Further reduced padding: vertical 4px, horizontal 6px */
  margin-top: 0; /* Remove any potential top margin */
}

/* Ensure the header takes up the entire width */
.wizard-step .card-header {
  width: 100% !important;
  padding: 0 !important;
  margin: 0;
  overflow: hidden;
}

/* Make the header wrapper take the full width with minimal vertical spacing */
.wizard-step .card-header > div {
  padding: 2px 4px !important; /* Further reduced: 2px vertical, 4px horizontal */
  width: 100%;
  margin-bottom: 0 !important;
}

/* --- Strategy Parameter Inputs Styling --- */
.param-row {
  display: flex;
  align-items: center;
  margin-bottom: 8px;
}

.param-label {
  width: 180px; /* Fixed width for labels */
  flex-shrink: 0;
  display: flex;
  align-items: center;
}

.param-input {
  flex-grow: 0;
}

/* --- Utility Classes --- */
.mb-2 { margin-bottom: 0.5rem !important; }
.mt-2 { margin-top: 0.5rem !important; }
.mb-3 { margin-bottom: 0.5rem !important; } /* Reduced from 1rem */
.mt-3 { margin-top: 1rem !important; }

/* Add more specific styles as needed */

/* --- Custom Button Group Styling --- */
/* Make inactive outline buttons in button groups more visible */
.btn-group > .btn.btn-outline-primary:not(.active) {
  background-color: #2a2e39; /* Slightly lighter dark shade */
  color: #adb5bd;           /* Lighter gray text */
  border-color: #444;       /* Subtle border */
}

/* Optional: Style for hover state */
.btn-group > .btn.btn-outline-primary:not(.active):hover {
  background-color: #343a40; /* Darken slightly on hover */
  color: #f8f9fa;           /* Lighter text on hover */
  border-color: #555;
}